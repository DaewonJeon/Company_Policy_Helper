# 🤖 사내 규정/계약서 AI 검토 비서 (RAG 기반)

> **목표**: 기술(AI)을 활용하여 비정형 데이터의 비효율을 해결하고, 조직의 '판단 비용'을 낮추는 RAG 시스템 구축  
> **기술 스택**: Python, LangChain, Streamlit, ChromaDB, OpenAI GPT-4o, Google Gemini

---

## 📋 프로젝트 개요

사내 규정집, 계약서 등 PDF 문서를 AI가 학습하고, 자연어 질문에 정확한 답변을 제공하는 **RAG(Retrieval-Augmented Generation)** 기반 챗봇입니다.

### 🎯 해결하는 문제

| 문제점 | 세부 내용 | 비즈니스 손실 |
|:---:|---|---|
| **정보의 파편화** | 규정집, 노무 가이드, 공지가 PDF, Word, 이메일에 흩어져 있음 | 정보 검색에만 업무 시간의 **20%** 소요 |
| **반복 답변 피로** | "경조사 휴가 며칠인가요?", "식대 한도가 얼마죠?" 같은 단순 질문 반복 | 담당자(HR/총무)의 **업무 몰입도 저하** |
| **휴먼 리스크** | 담당자의 기억에 의존한 답변으로 개정된 규정 놓침 | 법적 리스크 발생 가능성 |

### ✅ 기대 효과

- **정량적 효과**: 단순 질의응답 시간 **95% 단축**
- **정성적 효과**: '물어보면 1초 만에 대답해주는 비서' 도입으로 임직원 만족도 상승

---

## 🏗️ 시스템 아키텍처

### RAG (Retrieval-Augmented Generation) 파이프라인

```
┌─────────────────────────────────────────────────────────────────────┐
│                        사용자 질문                                    │
│              "경조사 휴가는 며칠인가요?"                                │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│  1단계: 벡터DB 검색 (retriever)                                       │
│  ─────────────────────────────                                      │
│  • 질문을 벡터(숫자)로 변환                                            │
│  • 유사한 문서 조각 검색 (예: 취업규칙 중 휴가 관련 부분)                   │
│  ★ 이 단계가 없으면 AI는 회사 규정을 전혀 모름!                           │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│  2단계: AI API 호출 (GPT-4o / Gemini)                                │
│  ──────────────────────────────────                                 │
│  • 검색된 문서 + 질문을 조합해서 프롬프트 생성                            │
│  • AI가 문서 내용을 바탕으로 답변 생성                                   │
└─────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────────┐
│  "경조사 휴가는 결혼 시 5일, 사망 시 3일입니다. (출처: 취업규칙.pdf)"       │
└─────────────────────────────────────────────────────────────────────┘
```

### 🔑 핵심 개념: 벡터DB vs AI API

| 구분 | 역할 | 비유 | 없으면? |
|------|------|------|---------|
| **벡터DB (ChromaDB)** | 회사 문서에서 질문과 관련된 내용을 **검색** | 🗄️ 도서관 사서 (관련 페이지 찾기) | AI가 답변할 근거 자체가 없음 |
| **AI API (GPT-4o/Gemini)** | 검색된 내용을 바탕으로 자연스러운 **답변 생성** | 🤖 전문 해설가 (내용 설명) | 검색 결과만 있고 답변 불가 |

> **둘 다 필요합니다!** 벡터DB 없이 AI만 호출하면 "일반론적 답변"만 나옵니다.  
> 벡터DB + AI 함께 사용해야 **회사의 실제 규정을 기반으로 정확한 답변**이 가능합니다.

---

## 📁 프로젝트 구조

```
Company_Policy_Helper/
├── 📁 ai_secretary/          # 메인 애플리케이션
│   ├── app.py                # 챗봇 UI (Streamlit)
│   ├── ingest.py             # PDF 학습기 (벡터DB 생성)
│   ├── requirements.txt      # 필수 라이브러리
│   ├── .env                  # API 키 설정
│   ├── 📁 data/              # PDF 파일 저장 폴더
│   └── 📁 chroma_db/         # 벡터 DB 저장소 (자동 생성)
│
├── 📄 README.md              # 프로젝트 소개 (현재 문서)
├── 📄 1_규정검토AI_설계및분석.md   # 설계 문서
├── 📄 2_규정검토AI_구현코드.md     # 구현 코드 가이드
└── 📄 3_규정검토AI_실행가이드.md   # 실행 가이드
```

---

## ⚙️ 기술 스택

| 기술 | 역할 | 선정 근거 |
|---|---|---|
| **LangChain** | RAG Framework | LLM과 문서를 연결하는 파이프라인을 쉽게 구축 |
| **Streamlit** | Chat UI | 파이썬만으로 ChatGPT 스타일 인터페이스 구현 |
| **OpenAI GPT-4o** | LLM (두뇌) | 한국어 문맥 이해도 최고, 복잡한 규정 해석 능력 탁월 |
| **Google Gemini** | LLM (대안) | 비용 효율적, 무료 티어 활용 가능 |
| **ChromaDB** | Vector Store | 로컬 파일로 저장되는 가벼운 벡터 DB |
| **pdfplumber** | PDF 파서 | 한국어 PDF 텍스트 추출 정확도 우수 |

---

## 🚀 빠른 시작 가이드

### 1. 사전 준비

- Python 3.10 이상 설치
- OpenAI API 키 발급 ([platform.openai.com](https://platform.openai.com/api-keys))
- (선택) Google AI API 키 발급 ([aistudio.google.com](https://aistudio.google.com/app/apikey))

### 2. 환경 설정

```powershell
# 프로젝트 폴더로 이동
cd Company_Policy_Helper\ai_secretary

# 가상환경 생성 및 활성화
python -m venv venv
.\venv\Scripts\activate

# 라이브러리 설치
pip install -r requirements.txt
```

### 3. API 키 설정

`.env` 파일을 열고 API 키를 입력하세요:

```env
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxxxxxxxxxxxxxx
GOOGLE_API_KEY=AIzaSy...  # (선택) Gemini 사용 시
```

### 4. 문서 학습시키기

```powershell
# data 폴더에 PDF 파일을 넣은 후 실행
python ingest.py
```

**출력 예시:**
```
🔄 문서 학습을 시작합니다...
   - 인사규정_2024.pdf 로드 완료 (15 페이지)
📊 총 42개의 지식 조각으로 분해되었습니다.
💾 벡터 DB에 저장 중...
✅ 학습 완료! 'chroma_db' 폴더에 저장되었습니다.
```

### 5. 챗봇 실행

```powershell
streamlit run app.py
```

브라우저에서 `http://localhost:8501` 로 접속하면 채팅 화면이 열립니다.

---

## 🎮 사용 방법

### AI 모델 선택

사이드바에서 원하는 AI 모델을 선택할 수 있습니다:

| 모델 | 특징 |
|------|------|
| **GPT-4o (OpenAI)** | 최신 멀티모달 모델, 빠르고 정확함 |
| **GPT-4o-mini (OpenAI)** | GPT-4o 경량 버전, 더 저렴하고 빠름 |
| **Gemini 2.5 Flash (Google)** | 빠른 응답, 비용 효율적 |
| **Gemini 2.5 Pro (Google)** | 복잡한 추론 및 코딩 작업에 적합 |
| **Gemini 3 Flash Preview (Google)** | 최신 모델, 향상된 멀티모달 기능 |

### 질문 예시

```
💬 "경조사 휴가는 며칠인가요?"
💬 "야근 식대 청구 기준이 어떻게 되나요?"
💬 "연차 신청 절차를 알려주세요."
💬 "계약서 3조에 독소 조항이 있나요?"
```

AI는 **제공된 PDF 내용 안에서만** 근거를 찾아 답변하며, 출처를 함께 표시합니다.

---

## 📊 상세 구현 현황

### 완료된 기능

| 단계 | 작업 내용 | 상태 |
|:----:|----------|:----:|
| 1 | 프로젝트 구조 설계 | ✅ |
| 2 | PDF 텍스트 추출 (pdfplumber) | ✅ |
| 3 | 텍스트 청킹 (1000자/200자 오버랩) | ✅ |
| 4 | 벡터DB 저장 (ChromaDB) | ✅ |
| 5 | RAG 파이프라인 구축 (LangChain LCEL) | ✅ |
| 6 | Streamlit 챗봇 UI | ✅ |
| 7 | OpenAI GPT-4o 연동 | ✅ |
| 8 | Google Gemini 연동 (신규) | ✅ |
| 9 | 멀티 모델 선택 기능 | ✅ |
| 10 | 근거 문서 표시 기능 | ✅ |

### 🎯 진행 상태 범례
- ⬜ 미착수
- 🔄 진행 중
- ✅ 완료
- ❌ 보류/취소

---

## 🛠️ 환각(Hallucination) 방지 전략

현업에서 가장 중요한 것은 **"거짓말을 하지 않는 것"**입니다.

1. **Prompt Engineering**: "문서에 없는 내용이면 '모르겠습니다'라고 대답해."라는 지시어를 명확히 포함
2. **Source Citation**: 답변 끝에 반드시 출처를 표시하도록 설계
3. **Temperature 0 설정**: 창의적 답변 대신 사실 기반 답변 유도

---

## 🔧 문제 해결 (Troubleshooting)

**Q. `RateLimitError`가 떠요.**
> OpenAI 계정에 결제 카드가 등록되지 않았거나 잔액이 부족합니다. Billing 페이지를 확인하세요.

**Q. 답변이 너무 느려요.**
> 인터넷 속도와 OpenAI 서버 상태의 영향을 받습니다. 보통 3~5초 정도 걸립니다.

**Q. 엉뚱한 대답을 해요.**
> PDF 내용이 너무 적거나, 질문과 관련된 키워드가 문서에 없을 수 있습니다. `app.py`의 `system_prompt`를 수정해서 AI 성격을 튜닝해보세요.

**Q. Google Gemini 모델이 작동 안 해요.**
> `.env` 파일에 `GOOGLE_API_KEY`가 올바르게 설정되어 있는지 확인하세요.

---

## 📚 관련 문서

| 문서 | 설명 |
|------|------|
| [1_규정검토AI_설계및분석.md](./1_규정검토AI_설계및분석.md) | 프로젝트 설계 및 기술적 분석 |
| [2_규정검토AI_구현코드.md](./2_규정검토AI_구현코드.md) | 구현 코드 상세 설명 |
| [3_규정검토AI_실행가이드.md](./3_규정검토AI_실행가이드.md) | 비전공자용 실행 가이드 |

---

## 📈 확장성 및 유지보수

### 데이터 보안
- **Local LLM 대체 가능**: 사내 보안이 중요하다면, OpenAI 대신 사내 서버에 구축된 오픈소스 모델(Llama 3 등)로 교체 가능 (LangChain의 장점)

### 유지보수
- 규정이 개정되면? → 새로운 PDF만 data 폴더에 넣고 `ingest.py`를 다시 실행 (재학습 비용 0원)

---

## 📝 결론

> 이 프로젝트는 단순 기술 도입을 넘어, **"회사의 지식 자산을 시스템화"**하는 AI Ops의 첫걸음입니다.

벡터DB와 AI API를 조합한 RAG 아키텍처를 통해:
- 🗄️ **벡터DB** = 회사 문서에서 관련 내용을 **검색**
- 🤖 **AI API** = 검색된 내용을 바탕으로 **자연어 답변 생성**

두 기술의 시너지로 **환각 없는 정확한 답변**을 제공합니다.

---

<p align="center">
  <b>🚀 기술(AI)로 비효율을 해결하고, 조직의 판단 비용을 낮추는 시스템</b>
</p>
