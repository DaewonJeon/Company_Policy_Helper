# [프로젝트 1] 원클릭 정산 및 리포트 자동화: 실행 가이드

> **목적**: 코딩을 모르는 팀장님도 따라 할 수 있는 상세한 실행 매뉴얼입니다.
> **소요 시간**: 초기 세팅 약 10분

---

## 1. 사전 준비 사항 (Prerequisites)

PC에 파이썬이 설치되어 있어야 합니다.

1.  **Python 설치**: [python.org](https://www.python.org/downloads/)에서 다운로드 (설치 시 `Add Python to PATH` 체크 필수!)
2.  **프로젝트 폴더 생성**: 바탕화면에 `one_click_report` 폴더를 만들고, [구현 코드] 문서에 있는 파일들을 넣어주세요.

---

## 2. 설치 및 환경 설정 (Installation)

### 2.1 가상환경 생성 (권장)
터미널(CMD 또는 PowerShell)을 열고 프로젝트 폴더로 이동한 뒤 입력하세요.

```bash
cd one_click_report
python -m venv venv
```

### 2.2 가상환경 활성화
*   **Windows**: `.\venv\Scripts\activate`
*   **Mac/Linux**: `source venv/bin/activate`

### 2.3 라이브러리 설치
`requirements.txt`에 적힌 필수 도구들을 설치합니다.

```bash
pip install -r requirements.txt
```

---

## 3. 이메일 발송 설정 (선택 사항)

결과 리포트를 이메일로 자동 발송하려면, 구글 계정의 **'앱 비밀번호'**가 필요합니다. (보안상 일반 비밀번호는 사용 불가)

1.  [Google 계정 설정](https://myaccount.google.com/) 접속
2.  `보안` 탭 -> `2단계 인증` 켜기
3.  `2단계 인증` 하단의 `앱 비밀번호` 검색 및 클릭
4.  앱 이름에 "Python Automation" 입력 후 생성
5.  나오는 16자리 비밀번호를 복사해두세요.

프로젝트 폴더에 `.env` 파일을 만들고 아래 내용을 채워넣습니다.

```env
GMAIL_USER=내이메일@gmail.com
GMAIL_PASSWORD=앱비밀번호16자리
```

---

## 4. 프로그램 실행 (Run)

모든 준비가 끝났습니다! 아래 명령어로 실행하세요.

```bash
streamlit run app.py
```

잠시 후 브라우저가 자동으로 열리며 프로그램이 실행됩니다. (`http://localhost:8501`)

---

## 5. 사용 방법 (User Manual)

1.  **준비**: 각 지점에서 받은 실적 엑셀 파일들을 준비합니다. (파일명에 `[강남점]` 처럼 대괄호로 지점명이 있어야 자동 인식됩니다.)
2.  **업로드**: 웹 화면의 "Browse files" 영역에 엑셀 파일들을 드래그 앤 드롭 합니다.
3.  **검증**: 파일에 문제가 있다면 빨간색 에러 메시지가 뜹니다. (예: 필수 컬럼 누락)
4.  **생성**: "🚀 리포트 생성 시작" 버튼을 누릅니다.
5.  **확인 및 전송**:
    *   화면 아래에 통합된 결과 표가 보입니다.
    *   `📥 엑셀 리포트 다운로드` 버튼으로 결과물을 저장합니다.
    *   팀장님 이메일 주소를 적고 `📧 이메일로 바로 전송`을 누르면 끝!

---

## 6. 자주 묻는 질문 (Troubleshooting)

**Q. 'streamlit'은 내부 또는 외부 명령이 아닙니다... 라고 떠요.**
A. 파이썬 설치 시 `Add to PATH`를 체크하지 않았거나, 가상환경이 활성화되지 않은 경우입니다. `python -m streamlit run app.py`로 실행해보세요.

**Q. 엑셀 파일이 안 읽혀요.**
A. 파일이 암호화되어 있거나, `.xls` (구버전) 포맷일 수 있습니다. `.xlsx` 포맷으로 저장해서 업로드해주세요.

**Q. 이메일이 안 가요.**
A. `.env` 파일에 비밀번호가 공백 없이 정확히 들어갔는지 확인해주세요. 또한, 회사 보안 네트워크에서는 지메일 포트(587)가 막혀있을 수 있습니다. 이 경우 핫스팟 등 외부망에서 테스트해보세요.
