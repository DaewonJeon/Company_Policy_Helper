# [프로젝트 1] 원클릭 정산 및 리포트 자동화: 설계 및 분석

> **목표**: "단순 개발자"가 아닌 **"비즈니스 임팩트를 만드는 오퍼레이터"**로서의 역량을 증명하기 위한 프로젝트 설계서
> **독자**: 채용 담당자, 현업 팀장, 그리고 이 프로젝트를 실제 구현할 개발자(나)

---

## 1. 비즈니스 개요 및 문제 정의 (Why)

이 프로젝트는 단순히 "파이썬으로 엑셀을 다룬다"가 목적이 아닙니다. **"조직의 비효율 비용을 제거한다"**는 경영학적 관점에서 접근해야 합니다.

### 1.1 문제 상황 (Pain Point)
지점별/부서별로 흩어져 있는 50개의 엑셀 파일(주간 실적)을 매주 취합해야 하는 상황입니다.

| 문제점 | 세부 내용 | 비즈니스 손실 |
|:---:|---|---|
| **시간 소모** | 파일 열기 → 복사 → 붙여넣기 반복 (단순 중노동) | **연간 200시간+** 낭비 (4시간/주 x 52주) |
| **휴먼 에러** | 복사 중 행 누락, 수식 깨짐, 오타 발생 | 잘못된 데이터로 인한 **의사결정 오류** |
| **확장성 부재** | 지점이 50개에서 100개로 늘어나면 업무량 2배 증가 | 인건비 선형 증가 구조 |

### 1.2 해결 솔루션 (Solution)
**"1초 자동화 툴"** 도입. 사용자가 웹 페이지에 파일들을 드래그만 하면, 파이썬 엔진이 전처리/검증/병합/리포팅을 수행합니다.

### 1.3 기대 효과 (ROI)
- **정량적 효과**: 주 4시간 → **1초 (99.9% 단축)**
- **정성적 효과**: 팀원들이 단순 반복 업무에서 해방되어 '분석'과 '전략'에 집중 가능. "야근 없는 팀" 문화 조성.

---

## 2. 기술적 접근 및 아키텍처 (How)

왜 VBA(엑셀 매크로)가 아니라 **Python + Web**인가? 에 대한 기술적 검증 근거입니다.

### 2.1 아키텍처 다이어그램

```mermaid
flowchart LR
    User[사용자 (팀장/실무자)]
    
    subgraph Frontend [UI Layer]
        Streamlit[Streamlit Web App]
        Upload[파일 업로더 (Drag & Drop)]
        Download[결과 다운로드 버튼]
    end
    
    subgraph Backend [Logic Layer]
        Pandas[Pandas Engine]
        Validation[데이터 검증기]
        Reporter[리포트 생성기]
    end
    
    subgraph Output [Result]
        MergedExcel[통합 실적 리포트.xlsx]
        Email[자동 발송 메일]
    end

    User --> Upload
    Upload --> Pandas
    Pandas --> Validation
    Validation --오류 발생 시--> User
    Validation --통과 시--> Reporter
    Reporter --> MergedExcel
    Reporter --> Email
    MergedExcel --> Download
```

### 2.2 기술 스택 선정 이유

| 기술 | 역할 | 선정 근거 (면접 답변용) |
|---|---|---|
| **Python** | Core Engine | 엑셀(VBA)보다 데이터 처리 속도가 월등히 빠르며, 라이브러리 생태계가 강력함. |
| **Pandas** | Data Processing | 50개 파일, 수십만 행의 데이터도 메모리 상에서 몇 초 만에 병합 가능. |
| **Streamlit** | UI Framework | HTML/CSS를 몰라도 파이썬만으로 **"배포 가능한 수준의 웹 UI"**를 가장 빠르게 개발 가능. |
| **Openpyxl** | Excel Reporting | 단순 값만 넣는 게 아니라, **"서식(스타일, 색상)"**까지 입혀서 '보고용 리포트'를 만들어야 하기 때문. |

---

## 3. 핵심 기능 논리 설계 (Logic)

가장 중요한 것은 **"데이터 무결성(Data Integrity)"**입니다. 단순히 합치는 게 아니라, **"틀린 데이터를 잡아내는 것"**이 핵심 경쟁력입니다.

### 3.1 프로세스 흐름도
1.  **Ingestion (수집)**: 업로드된 50개 파일 메모리에 로드.
2.  **Validation (검증)**:
    *   *파일명 규칙 준수 여부?* (예: `2401_[지점명]_실적.xlsx`)
    *   *필수 컬럼 존재 여부?* (예: '매출액', '날짜' 열이 있는지)
    *   *데이터 타입 확인?* ('매출액'에 문자가 섞여 있지는 않은지)
3.  **Transformation (변환)**:
    *   결측치(0 or Null) 처리.
    *   '지점명' 컬럼 자동 추가 (파일명에서 추출).
4.  **Aggregation (집계)**: 전체 병합 및 피벗 테이블 생성(지점별 합계).
5.  **Reporting (출력)**: 서식이 적용된 엑셀 생성 및 이메일 발송.

### 3.2 데이터 검증 시나리오 (Edge Case 대응)
현업에서는 항상 예외가 발생합니다. 이를 코드로 방어해야 합니다.

*   **Case A**: 지점 직원이 엑셀 양식을 마음대로 바꿔서 보냄.
    *   → **대응**: 필수 헤더(Header) 검사 로직 수행. 불일치 시 "OO지점 파일 양식 오류" 즉시 알림.
*   **Case B**: 숫자에 오타가 있음 (10,000 대신 1000o).
    *   → **대응**: `pd.to_numeric(errors='coerce')`로 변환 후 NaN 발생 행 추출하여 리포트.

---

## 4. 확장성 및 배포 전략 (Scalability)

### 4.1 배포 환경
*   **Local**: 개인 PC에서 `streamlit run app.py`로 즉시 실행. (보안 문제로 클라우드 업로드 불가한 사내 환경 대응)
*   **Server**: 사내 서버(Docker)에 띄워 URL로 팀 전체 공유 가능.

### 4.2 유지보수
*   모듈화된 구조(`src/processor.py`) 덕분에, 엑셀 양식이 바뀌어도 **설정 파일만 수정**하면 됨. 코드 전체를 뜯어고칠 필요 없음.

---
> **결론**: 이 프로젝트는 단순한 코딩 연습이 아니라, **"업무 프로세스 혁신(PI)"**의 모범 사례입니다.
